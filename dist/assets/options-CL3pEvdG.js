import{c as U,r as c,j as e,E as P,a as F,C as S,S as B,b as _,d as G}from"./shield-cALfkkfC.js";import{b as $,c as A,s as q,P as H,l as V}from"./settings-B4XEWWU_.js";import{e as E,D as R,s as I,S as j,i as O}from"./ai-anthropic-BM-RR7DF.js";/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=U("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=U("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),J=[{id:"eu-battery-regulation",name:"EU Battery Regulation",description:"Battery passport compliance (2023/1542) - 11 rules"},{id:"weee-electronics",name:"WEEE Electronics",description:"Electronic waste directive (2012/19/EU) - 6 rules"}];function k({icon:t,title:d,description:n,children:h}){return e.jsxs("section",{className:"options-section",children:[e.jsxs("div",{className:"options-section-header",children:[e.jsx("div",{className:"options-section-icon",children:t}),e.jsxs("div",{className:"options-section-info",children:[e.jsx("h2",{children:d}),e.jsx("p",{children:n})]})]}),e.jsx("div",{className:"options-section-content",children:h})]})}function r({label:t,description:d,children:n}){return e.jsxs("div",{className:"options-setting",children:[e.jsxs("div",{className:"options-setting-info",children:[e.jsx("span",{className:"options-setting-label",children:t}),d&&e.jsx("span",{className:"options-setting-desc",children:d})]}),e.jsx("div",{className:"options-setting-control",children:n})]})}function C({checked:t,onChange:d,disabled:n}){return e.jsx("button",{type:"button",role:"switch","aria-checked":t,className:`options-toggle ${t?"on":""} ${n?"disabled":""}`,onClick:()=>!n&&d(!t),disabled:n,children:e.jsx("span",{className:"options-toggle-thumb"})})}function Q(){const[t,d]=c.useState(E),[n,h]=c.useState(R),[o,y]=c.useState({provider:"anthropic"}),[x,f]=c.useState(!1),[v,T]=c.useState(!1),[b,g]=c.useState("idle"),[N,D]=c.useState(!1),a=c.useMemo(()=>$(o.provider),[o.provider]),M=c.useMemo(()=>A(o.provider),[o.provider]);c.useEffect(()=>{async function s(){const[i,l,u]=await Promise.all([O(j.general,E),O(j.compliance,R),V()]);d(i),h(l),y(u),f(!!u.customModel),D(!0)}s()},[]),c.useEffect(()=>{if(!N)return;const s=setTimeout(async()=>{g("saving");try{await Promise.all([I(j.general,t),I(j.compliance,n),q(o)]),g("saved"),setTimeout(()=>g("idle"),2e3)}catch(i){console.error("Failed to save settings:",i),g("error")}},500);return()=>clearTimeout(s)},[t,n,o,N]);const m=(s,i)=>{d(l=>({...l,[s]:i}))},w=(s,i)=>{h(l=>({...l,[s]:i}))},p=(s,i)=>{y(l=>({...l,[s]:i}))},z=s=>{const l=A(s)[0];y(u=>({...u,provider:s,model:l==null?void 0:l.id,customModel:void 0,baseUrl:void 0})),f(!1)},K=s=>{h(i=>{const l=i.enabledRulePacks.includes(s);return{...i,enabledRulePacks:l?i.enabledRulePacks.filter(u=>u!==s):[...i.enabledRulePacks,s]}})};return N?e.jsxs("div",{className:"options-page",children:[e.jsxs("header",{className:"options-header",children:[e.jsxs("div",{className:"options-header-left",children:[e.jsx(P,{size:28,color:"var(--color-primary)"}),e.jsxs("div",{children:[e.jsx("h1",{children:"TwinLens Options"}),e.jsx("p",{children:"Configure your Digital Product Passport viewer"})]})]}),e.jsxs("div",{className:"options-header-right",children:[b==="saving"&&e.jsx("span",{className:"options-save-status saving",children:"Saving..."}),b==="saved"&&e.jsxs("span",{className:"options-save-status saved",children:[e.jsx(F,{size:14})," Saved"]}),b==="error"&&e.jsxs("span",{className:"options-save-status error",children:[e.jsx(S,{size:14})," Error saving"]})]})]}),e.jsxs("main",{className:"options-main",children:[e.jsxs(k,{icon:e.jsx(W,{size:20}),title:"General",description:"Discovery, privacy, and display preferences",children:[e.jsx(r,{label:"Page Scanning",description:"How aggressively to scan pages for DPP content",children:e.jsxs("select",{className:"form-select options-select",value:t.scanIntensity,onChange:s=>m("scanIntensity",s.target.value),children:[e.jsx("option",{value:"none",children:"Disabled"}),e.jsx("option",{value:"passive",children:"Passive (on navigation)"}),e.jsx("option",{value:"active",children:"Active (continuous)"})]})}),e.jsx(r,{label:"Local-Only Mode",description:"Disable all network calls (registry, AI, URL resolution)",children:e.jsx(C,{checked:t.localOnlyMode,onChange:s=>m("localOnlyMode",s)})}),e.jsx(r,{label:"Theme",description:"Color scheme preference",children:e.jsxs("select",{className:"form-select options-select",value:t.theme,onChange:s=>m("theme",s.target.value),children:[e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]})}),e.jsx(r,{label:"Compact Mode",description:"Reduce spacing for smaller screens",children:e.jsx(C,{checked:t.compactMode,onChange:s=>m("compactMode",s)})}),e.jsx(r,{label:"Validation Mode",description:"How strictly to validate AAS files",children:e.jsxs("select",{className:"form-select options-select",value:t.validationMode,onChange:s=>m("validationMode",s.target.value),children:[e.jsx("option",{value:"strict",children:"Strict (full verification)"}),e.jsx("option",{value:"lenient",children:"Lenient (parse-only)"})]})})]}),e.jsxs(k,{icon:e.jsx(B,{size:20}),title:"Compliance",description:"Rule packs and validation preferences",children:[e.jsxs("div",{className:"options-subsection",children:[e.jsx("h3",{children:"Enabled Rule Packs"}),e.jsx("div",{className:"options-rule-packs",children:J.map(s=>e.jsxs("label",{className:"options-rule-pack",children:[e.jsx("input",{type:"checkbox",checked:n.enabledRulePacks.includes(s.id),onChange:()=>K(s.id)}),e.jsxs("div",{className:"options-rule-pack-info",children:[e.jsx("span",{className:"options-rule-pack-name",children:s.name}),e.jsx("span",{className:"options-rule-pack-desc",children:s.description})]})]},s.id))})]}),e.jsx(r,{label:"Severity Override",description:"How to treat warning-level issues",children:e.jsxs("select",{className:"form-select options-select",value:n.severityOverride,onChange:s=>w("severityOverride",s.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"treat-warn-as-error",children:"Treat warnings as errors"}),e.jsx("option",{value:"treat-warn-as-info",children:"Treat warnings as info"})]})}),e.jsx(r,{label:"Show Future Rules",description:"Display rules not yet in force",children:e.jsx(C,{checked:n.showFutureRules,onChange:s=>w("showFutureRules",s)})})]}),e.jsxs(k,{icon:e.jsx(Y,{size:20}),title:"AI Chat",description:"Configure AI assistant for asset questions",children:[e.jsx(r,{label:"Provider",description:(a==null?void 0:a.description)||"AI service provider",children:e.jsx("select",{className:"form-select options-select",value:o.provider,onChange:s=>z(s.target.value),disabled:t.localOnlyMode,children:H.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})}),(a==null?void 0:a.requiresApiKey)&&e.jsx(r,{label:"API Key",description:a.apiKeyDocsUrl?`Get from ${new URL(a.apiKeyDocsUrl).hostname}`:"Your API key for the selected provider",children:e.jsxs("div",{className:"input-with-toggle",children:[e.jsx("input",{type:v?"text":"password",className:"form-input",value:o.apiKey||"",onChange:s=>p("apiKey",s.target.value),placeholder:a.apiKeyPlaceholder||"Enter API key",disabled:t.localOnlyMode}),e.jsx("button",{type:"button",className:"input-toggle",onClick:()=>T(!v),title:v?"Hide API key":"Show API key",children:v?e.jsx(_,{size:16}):e.jsx(P,{size:16})})]})}),(a==null?void 0:a.supportsBaseUrl)&&e.jsx(r,{label:"Base URL",description:`Default: ${a.baseUrl}`,children:e.jsx("input",{type:"text",className:"form-input",value:o.baseUrl||"",onChange:s=>p("baseUrl",s.target.value),placeholder:a.baseUrl,disabled:t.localOnlyMode})}),e.jsx(r,{label:"Model",description:"Which model to use for responses",children:e.jsxs("div",{className:"options-model-control",children:[!x&&M.length>0?e.jsx("select",{className:"form-select options-select",value:o.model||"",onChange:s=>p("model",s.target.value),disabled:t.localOnlyMode,children:M.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}):e.jsx("input",{type:"text",className:"form-input",value:o.customModel||"",onChange:s=>p("customModel",s.target.value),placeholder:"e.g., gpt-4o, llama3.2, claude-sonnet-4",disabled:t.localOnlyMode}),(a==null?void 0:a.allowCustomModel)&&e.jsx("button",{type:"button",className:"options-model-toggle",onClick:()=>{if(x){p("customModel",void 0);const s=M[0];s&&p("model",s.id)}else p("model",void 0);f(!x)},disabled:t.localOnlyMode,children:x?"Use preset":"Custom"})]})}),e.jsx(r,{label:"Max Tokens",description:`Response length limit: ${o.maxTokens||1024}`,children:e.jsx("input",{type:"range",min:"256",max:"4096",step:"128",value:o.maxTokens||1024,onChange:s=>p("maxTokens",parseInt(s.target.value,10)),className:"options-slider",disabled:t.localOnlyMode})}),e.jsx(r,{label:"Temperature",description:`Creativity level: ${(o.temperature||.7).toFixed(1)}`,children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:o.temperature||.7,onChange:s=>p("temperature",parseFloat(s.target.value)),className:"options-slider",disabled:t.localOnlyMode})}),t.localOnlyMode&&e.jsxs("div",{className:"options-warning",children:[e.jsx(S,{size:14}),"AI features are disabled in Local-Only Mode"]})]})]}),e.jsxs("footer",{className:"options-footer",children:[e.jsx("p",{children:"TwinLens v0.1.0 - Privacy-first Digital Product Passport viewer"}),e.jsx("a",{href:"https://github.com/YOUR_USERNAME/twinlens/blob/main/docs/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",className:"options-footer-link",children:"Privacy Policy"})]})]}):e.jsxs("div",{className:"options-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading settings..."})]})}const L=document.getElementById("root");if(!L)throw new Error("Root element not found");G(L).render(e.jsx(c.StrictMode,{children:e.jsx(Q,{})}));
