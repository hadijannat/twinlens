import{c as U,r as p,j as e,E as P,a as F,C as S,S as K,b as B,d as $}from"./shield-cALfkkfC.js";import{b as G,c as A,s as q,P as H,l as V}from"./settings-B4XEWWU_.js";/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=U("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.451.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=U("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),j={general:"twinlens_general_settings",compliance:"twinlens_compliance_settings"},E={scanIntensity:"passive",localOnlyMode:!1,theme:"system",compactMode:!1,validationMode:"strict"},R={enabledRulePacks:["eu-battery-regulation"],severityOverride:"default",showFutureRules:!0},J=[{id:"eu-battery-regulation",name:"EU Battery Regulation",description:"Battery passport compliance (2023/1542) - 11 rules"},{id:"weee-electronics",name:"WEEE Electronics",description:"Electronic waste directive (2012/19/EU) - 6 rules"}];async function I(t,i){var o;try{if(typeof chrome<"u"&&((o=chrome==null?void 0:chrome.storage)!=null&&o.sync)){const d=await chrome.storage.sync.get(t);if(d[t])return{...i,...d[t]}}}catch(d){console.warn(`Failed to load ${t}:`,d)}return i}async function O(t,i){var o;try{typeof chrome<"u"&&((o=chrome==null?void 0:chrome.storage)!=null&&o.sync)&&await chrome.storage.sync.set({[t]:i})}catch(d){console.warn(`Failed to save ${t}:`,d)}}function w({icon:t,title:i,description:o,children:d}){return e.jsxs("section",{className:"options-section",children:[e.jsxs("div",{className:"options-section-header",children:[e.jsx("div",{className:"options-section-icon",children:t}),e.jsxs("div",{className:"options-section-info",children:[e.jsx("h2",{children:i}),e.jsx("p",{children:o})]})]}),e.jsx("div",{className:"options-section-content",children:d})]})}function c({label:t,description:i,children:o}){return e.jsxs("div",{className:"options-setting",children:[e.jsxs("div",{className:"options-setting-info",children:[e.jsx("span",{className:"options-setting-label",children:t}),i&&e.jsx("span",{className:"options-setting-desc",children:i})]}),e.jsx("div",{className:"options-setting-control",children:o})]})}function C({checked:t,onChange:i,disabled:o}){return e.jsx("button",{type:"button",role:"switch","aria-checked":t,className:`options-toggle ${t?"on":""} ${o?"disabled":""}`,onClick:()=>!o&&i(!t),disabled:o,children:e.jsx("span",{className:"options-toggle-thumb"})})}function Q(){const[t,i]=p.useState(E),[o,d]=p.useState(R),[n,y]=p.useState({provider:"anthropic"}),[v,f]=p.useState(!1),[x,T]=p.useState(!1),[b,g]=p.useState("idle"),[M,D]=p.useState(!1),a=p.useMemo(()=>G(n.provider),[n.provider]),N=p.useMemo(()=>A(n.provider),[n.provider]);p.useEffect(()=>{async function s(){const[l,r,h]=await Promise.all([I(j.general,E),I(j.compliance,R),V()]);i(l),d(r),y(h),f(!!h.customModel),D(!0)}s()},[]),p.useEffect(()=>{if(!M)return;const s=setTimeout(async()=>{g("saving");try{await Promise.all([O(j.general,t),O(j.compliance,o),q(n)]),g("saved"),setTimeout(()=>g("idle"),2e3)}catch{g("error")}},500);return()=>clearTimeout(s)},[t,o,n,M]);const m=(s,l)=>{i(r=>({...r,[s]:l}))},k=(s,l)=>{d(r=>({...r,[s]:l}))},u=(s,l)=>{y(r=>({...r,[s]:l}))},_=s=>{const r=A(s)[0];y(h=>({...h,provider:s,model:r==null?void 0:r.id,customModel:void 0,baseUrl:void 0})),f(!1)},z=s=>{d(l=>{const r=l.enabledRulePacks.includes(s);return{...l,enabledRulePacks:r?l.enabledRulePacks.filter(h=>h!==s):[...l.enabledRulePacks,s]}})};return M?e.jsxs("div",{className:"options-page",children:[e.jsxs("header",{className:"options-header",children:[e.jsxs("div",{className:"options-header-left",children:[e.jsx(P,{size:28,color:"var(--color-primary)"}),e.jsxs("div",{children:[e.jsx("h1",{children:"TwinLens Options"}),e.jsx("p",{children:"Configure your Digital Product Passport viewer"})]})]}),e.jsxs("div",{className:"options-header-right",children:[b==="saving"&&e.jsx("span",{className:"options-save-status saving",children:"Saving..."}),b==="saved"&&e.jsxs("span",{className:"options-save-status saved",children:[e.jsx(F,{size:14})," Saved"]}),b==="error"&&e.jsxs("span",{className:"options-save-status error",children:[e.jsx(S,{size:14})," Error saving"]})]})]}),e.jsxs("main",{className:"options-main",children:[e.jsxs(w,{icon:e.jsx(W,{size:20}),title:"General",description:"Discovery, privacy, and display preferences",children:[e.jsx(c,{label:"Page Scanning",description:"How aggressively to scan pages for DPP content",children:e.jsxs("select",{className:"form-select options-select",value:t.scanIntensity,onChange:s=>m("scanIntensity",s.target.value),children:[e.jsx("option",{value:"none",children:"Disabled"}),e.jsx("option",{value:"passive",children:"Passive (on navigation)"}),e.jsx("option",{value:"active",children:"Active (continuous)"})]})}),e.jsx(c,{label:"Local-Only Mode",description:"Disable all network calls (registry, AI, URL resolution)",children:e.jsx(C,{checked:t.localOnlyMode,onChange:s=>m("localOnlyMode",s)})}),e.jsx(c,{label:"Theme",description:"Color scheme preference",children:e.jsxs("select",{className:"form-select options-select",value:t.theme,onChange:s=>m("theme",s.target.value),children:[e.jsx("option",{value:"system",children:"System"}),e.jsx("option",{value:"light",children:"Light"}),e.jsx("option",{value:"dark",children:"Dark"})]})}),e.jsx(c,{label:"Compact Mode",description:"Reduce spacing for smaller screens",children:e.jsx(C,{checked:t.compactMode,onChange:s=>m("compactMode",s)})}),e.jsx(c,{label:"Validation Mode",description:"How strictly to validate AAS files",children:e.jsxs("select",{className:"form-select options-select",value:t.validationMode,onChange:s=>m("validationMode",s.target.value),children:[e.jsx("option",{value:"strict",children:"Strict (full verification)"}),e.jsx("option",{value:"lenient",children:"Lenient (parse-only)"})]})})]}),e.jsxs(w,{icon:e.jsx(K,{size:20}),title:"Compliance",description:"Rule packs and validation preferences",children:[e.jsxs("div",{className:"options-subsection",children:[e.jsx("h3",{children:"Enabled Rule Packs"}),e.jsx("div",{className:"options-rule-packs",children:J.map(s=>e.jsxs("label",{className:"options-rule-pack",children:[e.jsx("input",{type:"checkbox",checked:o.enabledRulePacks.includes(s.id),onChange:()=>z(s.id)}),e.jsxs("div",{className:"options-rule-pack-info",children:[e.jsx("span",{className:"options-rule-pack-name",children:s.name}),e.jsx("span",{className:"options-rule-pack-desc",children:s.description})]})]},s.id))})]}),e.jsx(c,{label:"Severity Override",description:"How to treat warning-level issues",children:e.jsxs("select",{className:"form-select options-select",value:o.severityOverride,onChange:s=>k("severityOverride",s.target.value),children:[e.jsx("option",{value:"default",children:"Default"}),e.jsx("option",{value:"treat-warn-as-error",children:"Treat warnings as errors"}),e.jsx("option",{value:"treat-warn-as-info",children:"Treat warnings as info"})]})}),e.jsx(c,{label:"Show Future Rules",description:"Display rules not yet in force",children:e.jsx(C,{checked:o.showFutureRules,onChange:s=>k("showFutureRules",s)})})]}),e.jsxs(w,{icon:e.jsx(Y,{size:20}),title:"AI Chat",description:"Configure AI assistant for asset questions",children:[e.jsx(c,{label:"Provider",description:(a==null?void 0:a.description)||"AI service provider",children:e.jsx("select",{className:"form-select options-select",value:n.provider,onChange:s=>_(s.target.value),disabled:t.localOnlyMode,children:H.map(s=>e.jsx("option",{value:s.id,children:s.label},s.id))})}),(a==null?void 0:a.requiresApiKey)&&e.jsx(c,{label:"API Key",description:a.apiKeyDocsUrl?`Get from ${new URL(a.apiKeyDocsUrl).hostname}`:"Your API key for the selected provider",children:e.jsxs("div",{className:"input-with-toggle",children:[e.jsx("input",{type:x?"text":"password",className:"form-input",value:n.apiKey||"",onChange:s=>u("apiKey",s.target.value),placeholder:a.apiKeyPlaceholder||"Enter API key",disabled:t.localOnlyMode}),e.jsx("button",{type:"button",className:"input-toggle",onClick:()=>T(!x),title:x?"Hide API key":"Show API key",children:x?e.jsx(B,{size:16}):e.jsx(P,{size:16})})]})}),(a==null?void 0:a.supportsBaseUrl)&&e.jsx(c,{label:"Base URL",description:`Default: ${a.baseUrl}`,children:e.jsx("input",{type:"text",className:"form-input",value:n.baseUrl||"",onChange:s=>u("baseUrl",s.target.value),placeholder:a.baseUrl,disabled:t.localOnlyMode})}),e.jsx(c,{label:"Model",description:"Which model to use for responses",children:e.jsxs("div",{className:"options-model-control",children:[!v&&N.length>0?e.jsx("select",{className:"form-select options-select",value:n.model||"",onChange:s=>u("model",s.target.value),disabled:t.localOnlyMode,children:N.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))}):e.jsx("input",{type:"text",className:"form-input",value:n.customModel||"",onChange:s=>u("customModel",s.target.value),placeholder:"e.g., gpt-4o, llama3.2, claude-sonnet-4",disabled:t.localOnlyMode}),(a==null?void 0:a.allowCustomModel)&&e.jsx("button",{type:"button",className:"options-model-toggle",onClick:()=>{if(v){u("customModel",void 0);const s=N[0];s&&u("model",s.id)}else u("model",void 0);f(!v)},disabled:t.localOnlyMode,children:v?"Use preset":"Custom"})]})}),e.jsx(c,{label:"Max Tokens",description:`Response length limit: ${n.maxTokens||1024}`,children:e.jsx("input",{type:"range",min:"256",max:"4096",step:"128",value:n.maxTokens||1024,onChange:s=>u("maxTokens",parseInt(s.target.value,10)),className:"options-slider",disabled:t.localOnlyMode})}),e.jsx(c,{label:"Temperature",description:`Creativity level: ${(n.temperature||.7).toFixed(1)}`,children:e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:n.temperature||.7,onChange:s=>u("temperature",parseFloat(s.target.value)),className:"options-slider",disabled:t.localOnlyMode})}),t.localOnlyMode&&e.jsxs("div",{className:"options-warning",children:[e.jsx(S,{size:14}),"AI features are disabled in Local-Only Mode"]})]})]}),e.jsxs("footer",{className:"options-footer",children:[e.jsx("p",{children:"TwinLens v0.1.0 - Privacy-first Digital Product Passport viewer"}),e.jsx("a",{href:"https://github.com/YOUR_USERNAME/twinlens/blob/main/docs/PRIVACY.md",target:"_blank",rel:"noopener noreferrer",className:"options-footer-link",children:"Privacy Policy"})]})]}):e.jsxs("div",{className:"options-loading",children:[e.jsx("div",{className:"spinner"}),e.jsx("p",{children:"Loading settings..."})]})}const L=document.getElementById("root");if(!L)throw new Error("Root element not found");$(L).render(e.jsx(p.StrictMode,{children:e.jsx(Q,{})}));
